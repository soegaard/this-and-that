#lang racket

(define (in-heart-beat n beat)
  (make-do-sequence
   (lambda ()
     (values (位 (pos) (when (= pos n) (beat)) #f) ; pos->element
             (位 (pos) (if (= pos n) 0 (+ pos 1))) ; next-pos
             0                                    ; initial-pos
             (位 (pos) #t)                         ; continue?
             #f
             #f))))

(for/sum ([i  100]
          [x (in-heart-beat 10 (位 () (display ".")))])
  i)

  